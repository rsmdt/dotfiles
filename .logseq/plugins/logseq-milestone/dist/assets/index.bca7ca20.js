import{h as m,r as d,j as p,F as M,a as s,B as h,S as v,A as q,C as b,T as C,R as k,b as A}from"./vendor.86730373.js";const S=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(o){if(o.ep)return;o.ep=!0;const n=r(o);fetch(o.href,n)}};S();const x=t=>{const e=t?.match(/\[\[(.+?)\]\]/g)?.slice(-1)[0];return m(e?.replaceAll(/^(\[\[)|(\]\])$/g,""),O()?.dateFormatter)},B=t=>{const e=t?.match(/\[\[(.+?)\]\]/g)?.slice(-1)[0];return e?t.replace(e,"").trim():t},E=t=>t?.children?.find(r=>r?.content==="milestones")?.children?.map(r=>{const i=r?.content;return{content:B(i),date:x(i)}}),I=async(t,e)=>logseq.Editor.getBlock(t,e),O=()=>logseq.settings,N=({uuid:t,forceUpdate:e})=>{const[r,i]=d.exports.useState(),[o,n]=d.exports.useState(!1);d.exports.useEffect(()=>{I(t,{includeChildren:!0}).then(c=>{const g=E(c);i(g)})},[t,e]);const a=c=>r?.filter(l=>l.date.isSame(c,"day"))?.map((l,w)=>{const y=l.date.isBefore(m(),"day");return s(C,{title:l.content,arrowPointAtCenter:!0,children:s("div",{className:`whitespace-nowrap bg-blue-200 rounded-sm mb-1 ${y?"opacity-50":""}`,children:l.content},l.date.valueOf()+w)})}),f=c=>{n(c)};return p(M,{children:[s("div",{className:"w-screen h-screen absolute bg-transparent",onClick:()=>logseq.hideMainUI()}),p("div",{className:`${o?"w-2/3":"w-1/3"} h-5/6 bg-white absolute top-12 right-4 shadow-lg p-1 overflow-auto rounded transition-all`,children:[s("div",{className:"absolute left-4 top-4",children:o?s(h,{shape:"circle",icon:s(v,{}),onClick:()=>f(!1)}):s(h,{shape:"circle",icon:s(q,{}),onClick:()=>f(!0)})}),s(b,{dateCellRender:a})]})]})};let u=new Map;console.log("[faiz:] === logseq-plugin-milestone loaded"),logseq.ready(()=>{logseq.Editor.registerSlashCommand("milestone",async()=>{const t=await logseq.Editor.getCurrentBlock();!t?.uuid||logseq.Editor.insertAtEditingCursor(`{{renderer milestone-${t.uuid}}}`)}),logseq.setMainUIInlineStyle({position:"fixed",zIndex:11}),logseq.provideModel({show(t){const e=t?.dataset?.faizUuid;F(e,u.get(e)||0),logseq.showMainUI()}}),logseq.App.onMacroRendererSlotted(async({slot:t,payload:e})=>{const r=u.get(e.uuid);if(u.set(e.uuid,r?r+1:1),!/^milestone/.test(e?.arguments?.[0]))return"milestone parse error";logseq.provideUI({key:"milestone",slot:t,reset:!0,template:`<a style="color: var(--ls-link-ref-text-color);" data-on-click="show" data-faiz-uuid="${e?.uuid}">show calender view</a>`})})});function F(t,e){k.render(s(A.StrictMode,{children:s(N,{uuid:t,forceUpdate:e})}),document.getElementById("root"))}
