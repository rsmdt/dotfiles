# CLAUDE.md

## Quick Reference

### Core Principles
- Test-Driven Development (TDD) is mandatory - Red, Green, Refactor
- Make sensible defaults, state assumptions inline
- Functions under 20 lines, single responsibility
- Security over performance, tests over speed
- Read files and documentation thoroughly - no skimming or assuming
- **Never lie or invent realities** - Everything stated must be fact-based
- **When making estimates or assumptions, explicitly outline them as such**
- **Distinguish between measured data and theoretical analysis**

### Common Commands
```bash
npm test          # Run tests
npm run lint      # Lint with fix
npm run typecheck # TypeScript check
git status        # Check changes
git diff          # Review changes
```

### Priority Order
1. Security over performance
2. Tests over development speed
3. Readability over cleverness
4. Explicit over implicit

## Architecture & Design

### Domain-Driven Design
- Model business concepts explicitly
- Use ubiquitous language from domain
- Encapsulate business rules in domain layer
- Keep domain free of framework dependencies

### Design Principles
- SOLID principles apply
- Prefer composition over inheritance
- Program to interfaces, not implementations
- Dependency injection for testability
- No barrel exports - always import from specific files

## Development Workflow

### File and Documentation Reading
- Always read files completely - never skim or assume content
- Read all relevant documentation before implementing
- Verify understanding by checking specific details
- Don't make assumptions about file contents

### Test-Driven Development
1. **Red**: Write failing test for desired behavior
2. **Green**: Write minimal code to pass
3. **Refactor**: Improve structure, keep tests green

### Git Workflow
- Small, focused commits
- Never commit broken code
- Never commit unless explicitly instructed

### Git Commit Messages
- Short and concise
- Intent-based: explain WHY, not WHAT changed
- Never list files added/changed/removed (git shows this)
- Never include Claude attribution or "Generated by" footers
- Use conventional commit style headlines
- Examples:
  - ✅ `feat: Supports dark mode toggle`
  - ✅ `fix: Prevents duplicate form submissions`
  - ❌ `feat: Added dark mode toggle to settings.tsx and theme.ts`
  - ❌ `Generated with Claude Code`

### Code Review Focus
- Test coverage and quality
- Security vulnerabilities
- Performance implications
- Maintainability

## Code Standards

### Naming Conventions
- Intention-revealing: `calculateTotalPrice()` not `calc()`
- No abbreviations: `userRepository` not `userRepo`
- Boolean prefixes: `is`, `has`, `can`, `should`
- Consistent terminology throughout

### Function Design
- Single responsibility per function
- Validate inputs at boundaries
- Return early for edge cases
- Handle errors explicitly

### Error Handling
- Validate inputs with specific messages
- Create custom error types
- Include context: what failed, expected values
- Generic messages to users, details in logs

### Security Practices
- Never hardcode secrets
- Validate all inputs
- Use parameterized queries
- Principle of least privilege
- Sanitize outputs for context

## Testing Strategy

### Test Organization
- One behavior per test
- Test through public interfaces
- Keep tests independent
- Co-locate with source files

### Mock Boundaries
- Mock external dependencies only
- Never mock internal code
- Test behavior, not implementation
- Use descriptive test names

### Coverage Requirements
- Test edge cases: null, empty, boundaries
- Test error conditions
- Test async operations
- Avoid testing framework code

## Performance & Optimization

### Optimization Process
- Measure before optimizing
- Profile actual bottlenecks
- Clear code first, optimize proven hot paths
- Document performance decisions

### Resource Management
- Clean up resources
- Batch operations when possible
- Implement caching strategically
- Use lazy loading patterns

### Data Handling
- Arrays for iteration
- Maps for lookups
- Sets for uniqueness
- Async/await for I/O

## Never Do
- Create files without necessity
- Add comments without purpose
- Commit without user request
- Mock internal application code
- Leave code in broken state
- Log or expose secrets
- Make assumptions about frameworks
- Implement backwards compatibility unless explicitly requested
- Maintain deprecated patterns or legacy code paths
- Add compatibility layers for old versions
- Use barrel exports (index.ts) - always import from specific files
